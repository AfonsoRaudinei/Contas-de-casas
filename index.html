<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Dashboard Financeiro - Raudinei üå±</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Inter, Roboto, Arial;
            background: linear-gradient(180deg, #f5f5f7 0%, #e5e5e7 100%);
            margin: 0;
            padding: 20px;
            color: #1d1d1f;
            min-height: 100vh;
        }
        
        .header {
            background: linear-gradient(180deg, #2c2c2e 0%, #1c1c1e 100%);
            border-radius: 18px;
            padding: 24px;
            margin-bottom: 24px;
            color: white;
            text-align: center;
            box-shadow: 0 12px 32px rgba(0,0,0,0.2);
        }
        
        .logo {
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, #34C759, #30D158);
            border-radius: 16px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            margin-bottom: 16px;
            box-shadow: 0 8px 24px rgba(52, 199, 89, 0.4);
        }
        
        .header h1 {
            font-size: 28px;
            font-weight: 700;
            margin: 0 0 8px 0;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(16px);
            border-radius: 18px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 12px 32px rgba(0,0,0,0.1), 0 4px 12px rgba(0,0,0,0.05);
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-bottom: 28px;
        }
        
        .section-title {
            font-size: 0.75em;
            color: #86868b;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            font-weight: 600;
            margin-bottom: 16px;
        }
        
        .form-row {
            display: flex;
            align-items: center;
            padding: 14px 0;
            border-bottom: 1px solid #e5e5e7;
        }
        
        .form-row:last-child { border-bottom: none; }
        
        .form-label {
            width: 100px;
            font-size: 15px;
            font-weight: 600;
            color: #1d1d1f;
        }
        
        input, select {
            flex: 1;
            padding: 12px;
            margin-left: 16px;
            border: none;
            border-radius: 12px;
            background: rgba(0,0,0,0.04);
            font-size: 16px;
            text-align: right;
        }
        
        input[type="number"] { max-width: 140px; }
        
        button {
            margin-top: 20px;
            padding: 16px 28px;
            border: none;
            border-radius: 14px;
            background: linear-gradient(135deg, #007AFF 0%, #0051D5 100%);
            color: white;
            font-size: 17px;
            font-weight: 600;
            width: 100%;
            box-shadow: 0 8px 24px rgba(0, 122, 255, 0.35);
            transition: all 0.3s;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(0, 122, 255, 0.45);
        }
        
        .value {
            font-size: 32px;
            font-weight: 800;
            text-align: center;
            margin: 16px 0;
            line-height: 1.2;
        }
        
        .positive { color: #30D158; }
        .negative { color: #FF3B30; }
        .neutral { color: #1d1d1f; }
        
        .chart-container {
            position: relative;
            height: 320px;
            margin: 20px 0;
        }
        
        table {
            width: 100%;
            margin-top: 20px;
            border-collapse: collapse;
        }
        
        th {
            color: #86868b;
            font-size: 0.8em;
            text-transform: uppercase;
            letter-spacing: 0.6px;
            font-weight: 600;
            padding: 16px 0 12px 0;
            text-align: left;
        }
        
        td {
            padding: 14px 0;
            border-bottom: 1px solid #e5e5e7;
            font-size: 15px;
        }
        
        .top-cat {
            background: linear-gradient(135deg, #fff8e1 0%, #fff3cd 100%);
            border: 1px solid rgba(255, 193, 7, 0.3);
            padding: 20px;
            border-radius: 14px;
            text-align: center;
            box-shadow: 0 4px 16px rgba(255, 152, 0, 0.12);
            border-left: 5px solid #ffc107;
        }
        
        @media (max-width: 768px) {
            .grid { grid-template-columns: 1fr; }
            .value { font-size: 26px; }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">üå±</div>
        <h1>Dashboard Financeiro</h1>
        <p>Raudinei Afonso - Controle Agr√≠cola</p>
    </div>

    <div class="card">
        <div class="section-title">Nova Despesa</div>
        <div class="form-row">
            <div class="form-label">Descri√ß√£o</div>
            <input id="desc" placeholder="Ex: Fertilizante NPK">
        </div>
        <div class="form-row">
            <div class="form-label">Categoria</div>
            <select id="cat">
                <option value="">Selecione...</option>
                <option value="Casa">üè† Casa</option>
                <option value="Laura">üë®‚Äçüë©‚Äçüëß Laura</option>
                <option value="Supermercado">üõí Supermercado</option>
                <option value="Cart√£o">üí≥ Cart√£o</option>
                <option value="Sa√∫de">üè• Sa√∫de</option>
                <option value="Previd√™ncia">üí∞ Previd√™ncia</option>
                <option value="Streaming">üì∫ Streaming</option>
                <option value="Fertilizantes">üå± Fertilizantes</option>
                <option value="Sementes">üåæ Sementes</option>
                <option value="Outros">üìã Outros</option>
            </select>
        </div>
        <div class="form-row">
            <div class="form-label">Valor</div>
            <input id="val" type="number" step="0.01" placeholder="0,00">
        </div>
        <button id="btnAdicionar">‚ûï Adicionar Despesa</button>
    </div>

    <div class="grid">
        <div class="card">
            <div class="section-title">Entradas</div>
            <div id="ent" class="value neutral">R$ 8.830,00</div>
        </div>
        <div class="card">
            <div class="section-title">Despesas</div>
            <div id="desp" class="value neutral">R$ 0,00</div>
        </div>
        <div class="card">
            <div class="section-title">Saldo</div>
            <div id="saldo" class="value positive">R$ 8.830,00</div>
        </div>
    </div>

    <div class="card">
        <div class="section-title">üìä Gastos por Categoria</div>
        <div class="chart-container">
            <canvas id="pizzaChart"></canvas>
        </div>
    </div>

    <div class="card">
        <div class="section-title">üèÜ Categoria que + Gastou</div>
        <div id="top" class="top-cat">Nenhuma despesa registrada</div>
    </div>

    <div class="card">
        <div class="section-title">üìã Despesas Lan√ßadas</div>
        <table id="lista">
            <thead>
                <tr>
                    <th>Descri√ß√£o</th>
                    <th>Categoria</th>
                    <th>Valor</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <script>
        const renda = 8830;
        let pizzaChart = null;

        function criarGrafico(dadosCat) {
            const ctx = document.getElementById('pizzaChart').getContext('2d');
            
            if (pizzaChart) pizzaChart.destroy();
            
            const cores = [
                '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', 
                '#9966FF', '#FF9F40', '#FF6384', '#C9CBCF'
            ];
            
            pizzaChart = new Chart(ctx, {
                type: 'doughnut',
                 {
                    labels: Object.keys(dadosCat),
                    datasets: [{
                         Object.values(dadosCat),
                        backgroundColor: cores.slice(0, Object.keys(dadosCat).length),
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                font: { size: 13 }
                            }
                        }
                    }
                }
            });
        }

        function carregar() {
            let dados = JSON.parse(localStorage.getItem('despesas') || '[]');
            let total = 0;
            let cat = {};

            const tbody = document.querySelector('#lista tbody');
            tbody.innerHTML = '';

            dados.forEach(d => {
                total += d.valor;
                cat[d.categoria] = (cat[d.categoria] || 0) + d.valor;

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${d.descricao}</td>
                    <td>${d.categoria}</td>
                    <td style="text-align: right; font-weight: 600;">R$ ${d.valor.toFixed(2)}</td>
                `;
                tbody.appendChild(tr);
            });

            // Atualiza valores
            document.getElementById('ent').innerText = `R$ ${renda.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            document.getElementById('desp').innerText = `R$ ${total.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;

            const s = renda - total;
            const saldo = document.getElementById('saldo');
            saldo.innerText = `R$ ${s.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            saldo.className = `value ${s >= 0 ? 'positive' : 'negative'}`;

            // Top categoria
            let mCat = 'Nenhuma despesa', mVal = 0;
            for(let k in cat) {
                if(cat[k] > mVal) {
                    mVal = cat[k];
                    mCat = k;
                }
            }
            document.getElementById('top').innerHTML = mCat === 'Nenhuma despesa' ? 
                'Nenhuma despesa registrada' : 
                `<strong>${mCat}</strong><br>R$ ${mVal.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;

            // Gr√°fico
            if(Object.keys(cat).length > 0) {
                criarGrafico(cat);
            } else {
                const ctx = document.getElementById('pizzaChart').getContext('2d');
                ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
            }
        }

        document.getElementById('btnAdicionar').onclick = function() {
            const descricao = document.getElementById('desc').value.trim();
            const categoria = document.getElementById('cat').value;
            const valor = parseFloat(document.getElementById('val').value) || 0;

            if(!descricao || !categoria || valor <= 0) {
                alert('‚úÖ Preencha descri√ß√£o, categoria e valor > 0');
                return;
            }

            let dados = JSON.parse(localStorage.getItem('despesas') || '[]');
            dados.push({descricao, categoria, valor,  new Date().toISOString()});
            localStorage.setItem('despesas', JSON.stringify(dados));

            // Limpa formul√°rio
            document.getElementById('desc').value = '';
            document.getElementById('cat').value = '';
            document.getElementById('val').value = '';
            
            carregar();
        }

        // Inicializa
        carregar();
    </script>
</body>
</html>
